<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap>

	<typeAlias alias="dto" type="ch11.logon.LogonDataBean" />

		<!-- 리절트 맵 정의 -->
	  	<resultMap id="dtoRes" class="dto">
		  	<result property="id" column="id"/>
		  	<result property="pw" column="pw"/>
		  	<result property="nickname" column="nickname"/>
		  	<result property="location" column="location"/>
		  	<result property="couple" column="couple"/>
		  	<result property="list" column="list"/>
		</resultMap>
	<typeAlias alias="cdto" type="ch11.logon.CoupleDataBean" />

		<!-- 리절트 맵 정의 -->
	  	<resultMap id="cdtoRes" class="cdto">
		  	<result property="coupleName" column="coupleName"/>
		  	<result property="coupleDate" column="coupleDate"/>
		  	<result property="id1" column="id1"/>
		  	<result property="id2" column="id2"/>
		  	<result property="point" column="point"/>
		  	<result property="coupleImage" column="coupleImage"/>
		</resultMap>
		<typeAlias alias="adto" type="ch11.logon.AlertDataBean" />

		<!-- 리절트 맵 정의 -->
	  	<resultMap id="adtoRes" class="adto">
	  		<result property="num" column="num"/>
		  	<result property="id" column="id"/>
		  	<result property="nickname" column="nickname"/>
		  	<result property="couplename" column="couplename"/>
		  	<result property="content" column="content"/>
		  	<result property="readcheck" column="readcheck"/>
		  	<result property="regdate" column="regdate"/>
		</resultMap>
		
		<!-- insert 쿼리문 정의 -->
		<insert id="insertMember" parameterClass="dto">
		
      		INSERT INTO dc_member(id,pw,nickname,location,couple) 
      		
                	 VALUES (
                	 		#id#,
                	 		#pw#,
                         	#nickname#,
                         	#location#,
                         	#couple#
                             )
		</insert>
		<insert id="insertCouple" parameterClass="cdto">
		
      		INSERT INTO dc_couple
      		
                	 VALUES (
                	 		#coupleName#,
                	 		#coupleDate#,
                         	#id1#,
                         	#id2#,
                         	#point#,
                         	#coupleImage#
                             )
		</insert>
		<insert id="insertAlert" parameterClass="adto">
		
      		INSERT INTO dc_alert(num,id,nickname,couplename,content)
                	 VALUES (
                	 		alert_seq.nextval,
                	 		#id#,
                	 		#nickname#,
                	 		#couplename#,
                	 		#content#
                             )
		</insert>
		<update id="updateMember" parameterClass="dto">
			UPDATE dc_member
                	 set 
                	 		pw=#pw#,
                         	nickname=#nickname#,
                         	location=#location#,
                         	couple=#couple#
                     where id=#id#
                            
		</update>
		<update id="memCouple1" parameterClass="String">
			UPDATE dc_member
				set
					couple='1'
				where id=#id#
		</update>
		<update id="memCouple0" parameterClass="String">
			UPDATE dc_member
				set
					couple='0'
				where id=#id#
		</update>
		<delete id="deleteMember" parameterClass="String">
			delete from dc_member
                	 
                     where id=#id#
                            
		</delete>
		<delete id="deleteCouple" parameterClass="String">
			delete from dc_couple where id1=#id# or id2=#id#
		</delete>
		<select id="getCoupleData" parameterClass="String" resultMap="cdtoRes">
			SELECT *from dc_couple where id2=#id# or id1=#id#
		</select>
		<select id="getMember" parameterClass="String" resultMap="dtoRes">
			SELECT *from dc_member where id=#id#
		</select>
		<select id="getMemberbyn" parameterClass="String" resultMap="dtoRes">
			SELECT *from dc_member where nickname=#nickname#
		</select>
		<select id="getMemberbync" parameterClass="String" resultClass="int">
			SELECT count(*)from dc_member where nickname=#nickname#
		</select>
		<select id="getCouple" parameterClass="String" resultClass="int">
			SELECT count(*) from dc_couple where id1=#id# or id2=#id#
		</select>
		<select id="confirmId" parameterClass="String" resultClass="int">
			SELECT count(*) FROM dc_member where id=#id# 
		</select>
		<select id="confirmNickname" parameterClass="String" resultClass="int">
			SELECT count(*) FROM dc_member where nickname=#nickname# 
		</select>
		<select id="confirmCoupleName" parameterClass="String" resultClass="int">
			SELECT count(*) FROM dc_couple where coupleName=#coupleName# 
		</select>
		<select id="userCheck" parameterClass="dto" resultClass="int">
			SELECT count(*) FROM dc_member where id=#id# and pw=#pw#
		</select>
		<select id="nickCheck" parameterClass="String" resultClass="int">
			SELECT count(*) FROM dc_member where id=#id# and nickname is null
		</select>
		<select id="FBuserCheck" parameterClass="String" resultClass="int">
			SELECT count(*) FROM dc_member where id=#id#
		</select>
		<select id="coupleCheck1" parameterClass="String" resultClass="int">
			SELECT count(*) FROM dc_couple where id1=#id#
		</select>
		<select id="coupleCheck2" parameterClass="String" resultClass="int">
			SELECT count(*) FROM dc_couple where id2=#id#
		</select>
		<select id="fbNickCheck" parameterClass="String" resultClass="int">
			SELECT count(nickname) from dc_member where id=#id#
		</select>
		<select id="searchNickCheck" parameterClass="dto" resultClass="int">
			SELECT count(*) FROM dc_member where id=#id# and nickname=#nickname#
		</select>
		<!-- select 쿼리문 정의 -->
		<select id="selectAll" resultMap="dtoRes">
			SELECT * FROM dc_member 
		</select>
		<select id="getAlert" parameterClass="String" resultClass="adto">
			select *from dc_alert where id=#id# and redcheck='0'
		</select>
		
		

</sqlMap>

